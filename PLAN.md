# 数据匹配机制优化计划

## 需求概述

1. **ID转NAME标签** - 扫描数据时将ID引用转换为可读的NAME显示
2. **按钮功能合成** - 整合数据转换、表同步等功能，减少按钮数量
3. **UI设计优化** - 符合游戏设计师直觉，数据展示清晰直观

## 实施方案

### Phase 1: ID到NAME转换服务

**新建文件**: `red.jiuzhou.analysis.aion.IdNameResolver.java`

```
核心功能：
├─ 从数据库加载各系统的ID->NAME映射
├─ 支持的系统：物品、NPC、技能、任务、副本等
├─ LRU缓存机制（避免重复查询）
├─ 批量解析接口（提高效率）
└─ 格式化输出："ID (NAME)" 或仅 "NAME"
```

**映射表配置**:
| 系统 | 表名 | ID字段 | NAME字段 |
|------|------|--------|----------|
| 物品系统 | items | id | name |
| NPC系统 | npcs | id | name |
| 技能系统 | skill_base | id | name |
| 任务系统 | quest | id | name |
| 副本系统 | instance | id | name |

### Phase 2: UI整合 - 数据操作中心

**整合按钮**: 将分散的数据转换、表同步、批量操作合并为一个入口

```
原有按钮（6个）:
├─ 🔄 数据转换
├─ 🔁 表同步
├─ 📤 批量导出
├─ 📥 批量导入
├─ ✏️ 批量编辑
└─ ✅ 数据校验

合并为（2个）:
├─ 📊 数据操作中心（新窗口，整合所有数据操作）
└─ ✅ 数据校验（保留，高频使用）
```

**数据操作中心窗口设计**:
```
┌─────────────────────────────────────────────────┐
│  📊 数据操作中心                          [×] │
├─────────────────────────────────────────────────┤
│ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐│
│ │ 📤导出  │ │ 📥导入  │ │ 🔁同步  │ │ ✏️编辑  ││
│ │ DB→XML │ │ XML→DB │ │客户↔服务│ │ 批量改  ││
│ └─────────┘ └─────────┘ └─────────┘ └─────────┘│
├─────────────────────────────────────────────────┤
│ 操作范围: ○当前表 ○选中文件夹 ○全部表        │
├─────────────────────────────────────────────────┤
│ [表/文件列表 - 可多选]                         │
│ ☑ items.xml (物品表)                           │
│ ☑ npcs.xml (NPC表)                             │
│ ☐ skills.xml (技能表)                          │
│ ...                                             │
├─────────────────────────────────────────────────┤
│ 高级选项:                                       │
│ ☑ 显示ID对应的NAME  ☑ 自动备份  ☐ AI辅助     │
├─────────────────────────────────────────────────┤
│ [预览变更]              [执行操作]             │
└─────────────────────────────────────────────────┘
```

### Phase 3: 表格数据展示增强

**增强PaginatedTable**:
1. 检测ID字段（item_id, npc_id, skill_id等）
2. 自动查询对应的NAME
3. 显示格式: `123 (火球术)` 或悬停提示

**实现方式**:
- 表格渲染时检查列名
- 匹配ID字段模式后查询IdNameResolver
- 使用自定义CellFactory显示格式化内容

### Phase 4: 工具栏优化

**新工具栏布局**（减少到8个核心按钮）:
```
┌─────────────────────────────────────────────────────────┐
│ [数据浏览] [数据操作] [关系分析] [设计洞察] │ 状态信息 │
├─────────────────────────────────────────────────────────┤
│  🔗对照  │ 📊操作中心│ 🔍关联分析│ 🎮机制浏览│ 📡DB:xxx│
│  📁路径  │ ✅数据校验│ 🔗关系图  │ 📊设计洞察│         │
└─────────────────────────────────────────────────────────┘
```

**分组逻辑**:
- **数据浏览**: 查看和配置数据源
- **数据操作**: 导入/导出/同步/编辑（整合后）
- **关系分析**: 字段关联和机制关系
- **设计洞察**: AI分析和可视化

## 文件修改清单

### 新建文件
1. `red/jiuzhou/analysis/aion/IdNameResolver.java` - ID到NAME解析服务
2. `red/jiuzhou/ui/DataOperationCenterStage.java` - 数据操作中心窗口

### 修改文件
1. `red/jiuzhou/ui/Dbxmltool.java` - 工具栏按钮整合
2. `red/jiuzhou/ui/PaginatedTable.java` - 表格ID->NAME显示
3. `red/jiuzhou/ui/features/FeatureRegistry.java` - 注册新特性

## 预期效果

1. **ID可读性**: 所有ID字段自动显示对应NAME，设计师一目了然
2. **操作集中**: 数据操作从6个按钮减少到2个，入口清晰
3. **界面简洁**: 工具栏从12个按钮减少到8个，分组更合理
4. **设计师友好**: 操作流程符合策划工作习惯
